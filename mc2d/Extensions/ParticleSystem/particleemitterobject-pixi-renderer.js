var gdjs;(function(l){const m=GlobalPIXIModule.PIXI;class a{constructor(t,r,e){this.started=!1;let s=null;const i=new m.Graphics;if(i.lineStyle(0,0,0),i.beginFill(l.rgbToHexNumber(255,255,255),1),e.rendererType==="Point")i.drawCircle(0,0,e.rendererParam1);else if(e.rendererType==="Line")i.drawRect(e.rendererParam1,0,e.rendererParam1,e.rendererParam2),i.beginFill(l.rgbToHexNumber(255,255,255),.001),i.drawRect(0,0,e.rendererParam1,e.rendererParam2);else if(e.textureParticleName){const u=new m.Sprite(t.getGame().getImageManager().getPIXITexture(e.textureParticleName));u.width=e.rendererParam1,u.height=e.rendererParam2,i.addChild(u)}else i.drawRect(0,0,e.rendererParam1,e.rendererParam2);i.endFill(),s=t.getGame().getRenderer().getPIXIRenderer().generateTexture(i);const n={color:{list:[{value:l.rgbToHexNumber(e.particleRed1,e.particleGreen1,e.particleBlue1).toString(16),time:0},{value:l.rgbToHexNumber(e.particleRed2,e.particleGreen2,e.particleBlue2).toString(16),time:1}],isStepped:!1},acceleration:{x:e.particleGravityX,y:e.particleGravityY},lifetime:{min:e.particleLifeTimeMin,max:e.particleLifeTimeMax},frequency:e.flow<0?1e-4:1/e.flow,spawnChance:1,particlesPerWave:e.flow<0?e.maxParticleNb:1,maxParticles:e.maxParticleNb,emitterLifetime:a.computeLifetime(e.flow,e.tank),pos:{x:0,y:0},addAtBack:!1,spawnType:"circle",spawnCircle:{x:0,y:0,r:e.zoneRadius}};n.speed={list:[{time:0,value:e.emitterForceMax}],minimumSpeedMultiplier:e.emitterForceMax!==0?e.emitterForceMin/e.emitterForceMax:1,isStepped:!1},n.alpha={list:[{time:0,value:e.particleAlpha1/255},{time:1,value:e.particleAlpha2/255}],isStepped:!1};let x=e.particleSize1/100,f=e.particleSize2/100;const p=e.particleSizeRandomness1/100,d=e.particleSizeRandomness2/100,v=d!==0?(1+p)/(1+d):1;n.scale={list:[{time:0,value:x*(1+p)},{time:1,value:f*(1+d)}],minimumScaleMultiplier:v,isStepped:!1},n.startRotation={min:-e.emitterAngleB/2,max:e.emitterAngleB/2};const g=(e.particleLifeTimeMin+e.particleLifeTimeMax)/2;n.rotationSpeed={min:e.particleAngle1/g,max:e.particleAngle2/g},n.blendMode=e.additive?"ADD":"NORMAL",this.renderer=new m.Container,this.emitter=new m.particles.Emitter(this.renderer,s,n),this.start();const h=t.getLayer(r.getLayer());h&&h.getRenderer().addRendererObject(this.renderer,r.getZOrder())}getRendererObject(){return this.renderer}update(t){this.emitter.update(t),!this.started&&this.getParticleCount()>0&&(this.started=!0)}setPosition(t,r){this.emitter.spawnPos.x=t,this.emitter.spawnPos.y=r}setAngle(t,r){this.emitter.minStartRotation=t,this.emitter.maxStartRotation=r}setForce(t,r){this.emitter.startSpeed.value=r,this.emitter.minimumSpeedMultiplier=r!==0?t/r:1}setZoneRadius(t){this.emitter.spawnCircle.radius=t}setLifeTime(t,r){this.emitter.minLifetime=t,this.emitter.maxLifetime=r}setGravity(t,r){this.emitter.acceleration.x=t,this.emitter.acceleration.y=r}setColor(t,r,e,s,i,o){this.emitter.startColor.value.r=t,this.emitter.startColor.value.g=r,this.emitter.startColor.value.b=e,this.emitter.startColor.next=this.emitter.startColor.next||{time:1,value:{}},this.emitter.startColor.next.value.r=s,this.emitter.startColor.next.value.g=i,this.emitter.startColor.next.value.b=o}setSize(t,r){this.emitter.startScale.value=t/100,this.emitter.startScale.next&&(this.emitter.startScale.next.value=r/100)}setAlpha(t,r){this.emitter.startAlpha.value=t/255,this.emitter.startAlpha.next&&(this.emitter.startAlpha.next.value=r/255)}setFlow(t,r){this.emitter.frequency=t<0?1e-4:1/t,this.emitter.emitterLifetime=a.computeLifetime(t,r)}resetEmission(t,r){this.setFlow(t,r);const e=this.emitter.emit;this.start(),e||this.stop()}isTextureNameValid(t,r){const e=r.getGame().getImageManager().getInvalidPIXITexture(),s=r.getGame().getImageManager().getPIXITexture(t);return s.valid&&s!==e}setTextureName(t,r){const e=r.getGame().getImageManager().getInvalidPIXITexture(),s=r.getGame().getImageManager().getPIXITexture(t);s.valid&&s!==e&&(this.emitter.particleImages[0]=s)}getParticleCount(){return this.emitter.particleCount}stop(){this.emitter.emit=!1}start(){this.emitter.emit=!0}recreate(){this.emitter.cleanup()}destroy(){this.emitter.destroy()}hasStarted(){return this.started}static computeLifetime(t,r){return r<0?-1:t<0?.001:(r+.1)/t}}l.ParticleEmitterObjectPixiRenderer=a,l.ParticleEmitterObjectRenderer=a})(gdjs||(gdjs={}));
//# sourceMappingURL=particleemitterobject-pixi-renderer.js.map
